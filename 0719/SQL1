SELECT DEPTNO FROM EMP;
SELECT COUNT(*) FROM EMP;

SELECT DEPTNO,COUNT(*) FROM EMP
GROUP BY DEPTNO;

SELECT ENAME, COUNT(*) FROM EMP
GROUP BY ENAME;

SELECT JOB, MAX(SAL) FROM EMP
GROUP BY JOB;

SELECT JOB, DEPTNO, MAX(SAL), MIN(SAL) FROM EMP
GROUP BY JOB, DEPTNO;

SELECT DEPTNO, COUNT(*) FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) > 3;

SELECT DEPTNO, JOB, AVG(SAL) FROM EMP
WHERE SAL <= 3000
GROUP BY DEPTNO, JOB
HAVING AVG(SAL) >= 2000;

SELECT * FROM EMP;
SELECT * FROM DEPT;

--JOIN
SELECT * 
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;

SELECT * FORM EMP;
SELECT * FORM SALGRADE;

SELECT *
FROM EMP E, SALGRADE S;

SELECT *
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;

--자체 조인
SELECT E1.EMPNO, E1.ENAME, E2.ENAME AS "매니저"
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR;

--자체 JOIN 같은 감독의 다른 영화를 찾아주세요
--영화제목, 감독
SELECT * FROM MOVIES;
SELECT M1.TITLE, M2.DIRECTOR
FROM MOVIES M1, MOVIES M2
WHERE M1.DIRECTOR = M2.DIRECTOR
        AND M1.TITLE != M2.TITLE;
        
--연속 개봉 연도 영화를 찾아주세요
--같은 연속된 해에 개봉한 영화를 찾아서 출력해 주세요
SELECT * FROM MOVIES;
SELECT M1.TITLE, M2.TITLE
FROM MOVIES M1, MOVIES M2
WHERE TO_CHAR(M1.RELEASE_DATE, 'YYYY') = TO_CHAR(M2.RELEASE_DATE, 'YYYY')
        AND M1.TITLE !=M2.TITLE;

--LEFT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.EMPNO(+);
--RIGHT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR(+) = E2.EMPNO;








